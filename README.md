## 目的
GA4、GTMの検証環境を構築する

## 環境構築
https://qiita.com/at-sacai/items/cdb189996cbbacfc51e6
https://rikizoo.github.io/GA4_debug/

## 実装
<details>
  <summary>イベントスコープでの参照元を取得する</summary>

  ### 目的
  * セッションスコープで見るべきではない場面でもセッションの参照元/メディアを使用してしまうことを防ぐため、イベントスコープの参照元を実装する
  
  ### 前提知識
  * GA4にデフォルトで設定されているのはセッションスコープでの参照元のみ</br>※Refererでイベントスコープの取得もできるがSPAサイトくらいでしか正確なデータが取れない</br>
    | ディメンション名 | 意味 |
    | ---- | ---- |
    | ユーザーの参照元/メディア | そのユーザーの最初のセッションの参照元/メディア |
    | セッションの参照元/メディア | セッションの最初の参照元/メディア |
    | 参照元/メディア | キーイベントが行われたセッションの最初の参照元/メディア |
  * utmパラメータ(URL末尾にクエリ文字列を追加)を使用して参照元を判別する
    * utm_medium, utm_sourceは必須、utm_content,utm_campaignもあった方がいい
    * [URL 生成ツール: カスタム URL でキャンペーン データを収集する](https://support.google.com/analytics/answer/10917952?hl=ja)

  ### GTM
  1. utmパラメータを取得するためのカスタム変数を作成する
  2. 1で取得した値が各種イベントをトリガーとしたイベントパラメータとして送信されるように設定
  3. プレビューutmパラメータを追加したURLを開き、想定通りの値が入っているか確認する
  
  ### GA4
  1. GTMで送信したイベントパラメータをカスタムディメンションとして定義する
</details>
